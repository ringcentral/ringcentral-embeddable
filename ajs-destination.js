"use strict";(self.webpackChunkringcentral_embeddable=self.webpackChunkringcentral_embeddable||[]).push([[464],{318598:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function isPlanEventEnabled(plan,planEvent){var _a,_b;return"boolean"==typeof(null==planEvent?void 0:planEvent.enabled)?planEvent.enabled:null===(_b=null===(_a=null==plan?void 0:plan.__default)||void 0===_a?void 0:_a.enabled)||void 0===_b||_b}__webpack_require__.d(__webpack_exports__,{n:function(){return isPlanEventEnabled}})},888009:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LegacyDestination:function(){return LegacyDestination},ajsDestinations:function(){return ajsDestinations}});var tslib_es6=__webpack_require__(207698),dist=__webpack_require__(649969),connection=__webpack_require__(465904),context=__webpack_require__(129784),esm_context=__webpack_require__(230466),environment=__webpack_require__(969699),delivery=__webpack_require__(769147),is_plan_event_enabled=__webpack_require__(318598),merged_options=__webpack_require__(800913),p_while=__webpack_require__(956749),priority_queue=__webpack_require__(710360),persisted=__webpack_require__(165976),middleware=__webpack_require__(866170),parse_cdn=__webpack_require__(499382),load_script=__webpack_require__(666548);function normalizeName(name){return name.toLowerCase().replace(".","").replace(/\s+/g,"-")}function obfuscatePathName(pathName,obfuscate){return void 0===obfuscate&&(obfuscate=!1),obfuscate?btoa(pathName).replace(/=/g,""):void 0}function loadIntegration(ctx,name,version,obfuscate){return(0,tslib_es6.mG)(this,void 0,void 0,(function(){var pathName,obfuscatedPathName,path,fullPath,err_1,deps;return(0,tslib_es6.Jh)(this,(function(_a){switch(_a.label){case 0:pathName=normalizeName(name),obfuscatedPathName=obfuscatePathName(pathName,obfuscate),path=(0,parse_cdn.Kg)(),fullPath="".concat(path,"/integrations/").concat(null!=obfuscatedPathName?obfuscatedPathName:pathName,"/").concat(version,"/").concat(null!=obfuscatedPathName?obfuscatedPathName:pathName,".dynamic.js.gz"),_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,(0,load_script.v)(fullPath)];case 2:return _a.sent(),function(fullPath,ctx,name){var _a,_b;try{var metric=(null!==(_b=null===(_a=null===window||void 0===window?void 0:window.performance)||void 0===_a?void 0:_a.getEntriesByName(fullPath,"resource"))&&void 0!==_b?_b:[])[0];metric&&ctx.stats.gauge("legacy_destination_time",Math.round(metric.duration),(0,tslib_es6.ev)([name],metric.duration<100?["cached"]:[],!0))}catch(_){}}(fullPath,ctx,name),[3,4];case 3:throw err_1=_a.sent(),ctx.stats.gauge("legacy_destination_time",-1,["plugin:".concat(name),"failed"]),err_1;case 4:return deps=window["".concat(pathName,"Deps")],[4,Promise.all(deps.map((function(dep){return(0,load_script.v)(path+dep+".gz")})))];case 5:return _a.sent(),window["".concat(pathName,"Loader")](),[2,window["".concat(pathName,"Integration")]]}}))}))}var helpers=__webpack_require__(555469);function flushQueue(xt,queue){return(0,tslib_es6.mG)(this,void 0,void 0,(function(){var failedQueue,_this=this;return(0,tslib_es6.Jh)(this,(function(_a){switch(_a.label){case 0:return failedQueue=[],(0,connection.s)()?[2,queue]:[4,(0,p_while.x)((function(){return queue.length>0&&(0,connection.G)()}),(function(){return(0,tslib_es6.mG)(_this,void 0,void 0,(function(){var ctx,result;return(0,tslib_es6.Jh)(this,(function(_a){switch(_a.label){case 0:return(ctx=queue.pop())?[4,(0,delivery.a)(ctx,xt)]:[2];case 1:return result=_a.sent(),result instanceof context._||failedQueue.push(ctx),[2]}}))}))}))];case 1:return _a.sent(),failedQueue.map((function(failed){return queue.pushWithBackoff(failed)})),[2,queue]}}))}))}var LegacyDestination=function(){function LegacyDestination(name,version,writeKey,settings,options,integrationSource){void 0===settings&&(settings={}),this.options={},this.type="destination",this.middleware=[],this._ready=!1,this._initialized=!1,this.flushing=!1,this.name=name,this.version=version,this.settings=(0,tslib_es6.pi)({},settings),this.disableAutoISOConversion=options.disableAutoISOConversion||!1,this.integrationSource=integrationSource,this.settings.type&&"browser"===this.settings.type&&delete this.settings.type,this.options=options,this.buffer=options.disableClientPersistence?new priority_queue.Z(4,[]):new persisted.$(4,"".concat(writeKey,":dest-").concat(name)),this.scheduleFlush()}return LegacyDestination.prototype.isLoaded=function(){return this._ready},LegacyDestination.prototype.ready=function(){var _a;return null!==(_a=this.onReady)&&void 0!==_a?_a:Promise.resolve()},LegacyDestination.prototype.load=function(ctx,analyticsInstance){var _a;return(0,tslib_es6.mG)(this,void 0,void 0,(function(){var integrationSource,_b,_this=this;return(0,tslib_es6.Jh)(this,(function(_c){switch(_c.label){case 0:return this._ready||void 0!==this.onReady?[2]:null===(_a=this.integrationSource)||void 0===_a?[3,1]:(_b=_a,[3,3]);case 1:return[4,loadIntegration(ctx,this.name,this.version,this.options.obfuscate)];case 2:_b=_c.sent(),_c.label=3;case 3:integrationSource=_b,this.integration=function(integrationSource,integrationSettings,analyticsInstance){var integrationCtr;"Integration"in integrationSource?(integrationSource({user:function(){return analyticsInstance.user()},addIntegration:function(){}}),integrationCtr=integrationSource.Integration):integrationCtr=integrationSource;var integration=new integrationCtr(integrationSettings);return integration.analytics=analyticsInstance,integration}(integrationSource,this.settings,analyticsInstance),this.onReady=new Promise((function(resolve){_this.integration.once("ready",(function(){_this._ready=!0,resolve(!0)}))})),this.onInitialize=new Promise((function(resolve){_this.integration.on("initialize",(function(){_this._initialized=!0,resolve(!0)}))}));try{ctx.stats.increment("analytics_js.integration.invoke",1,["method:initialize","integration_name:".concat(this.name)]),this.integration.initialize()}catch(error){throw ctx.stats.increment("analytics_js.integration.invoke.error",1,["method:initialize","integration_name:".concat(this.name)]),error}return[2]}}))}))},LegacyDestination.prototype.unload=function(_ctx,_analyticsInstance){return function(name,version,obfuscate){return(0,tslib_es6.mG)(this,void 0,void 0,(function(){var path,pathName,obfuscatedPathName,fullPath;return(0,tslib_es6.Jh)(this,(function(_a){return path=(0,parse_cdn.Kg)(),pathName=normalizeName(name),obfuscatedPathName=obfuscatePathName(name,obfuscate),fullPath="".concat(path,"/integrations/").concat(null!=obfuscatedPathName?obfuscatedPathName:pathName,"/").concat(version,"/").concat(null!=obfuscatedPathName?obfuscatedPathName:pathName,".dynamic.js.gz"),[2,(0,load_script.t)(fullPath)]}))}))}(this.name,this.version,this.options.obfuscate)},LegacyDestination.prototype.addMiddleware=function(){for(var _a,fn=[],_i=0;_i<arguments.length;_i++)fn[_i]=arguments[_i];this.middleware=(_a=this.middleware).concat.apply(_a,fn)},LegacyDestination.prototype.shouldBuffer=function(ctx){return"page"!==ctx.event.type&&((0,connection.s)()||!1===this._ready||!1===this._initialized)},LegacyDestination.prototype.send=function(ctx,clz,eventType){var _a,_b;return(0,tslib_es6.mG)(this,void 0,void 0,(function(){var plan,ev,planEvent,afterMiddleware,event,err_1;return(0,tslib_es6.Jh)(this,(function(_c){switch(_c.label){case 0:if(this.shouldBuffer(ctx))return this.buffer.push(ctx),this.scheduleFlush(),[2,ctx];if(plan=null===(_b=null===(_a=this.options)||void 0===_a?void 0:_a.plan)||void 0===_b?void 0:_b.track,ev=ctx.event.event,plan&&ev&&"Segment.io"!==this.name){if(planEvent=plan[ev],!(0,is_plan_event_enabled.n)(plan,planEvent))return ctx.updateEvent("integrations",(0,tslib_es6.pi)((0,tslib_es6.pi)({},ctx.event.integrations),{All:!1,"Segment.io":!0})),ctx.cancel(new esm_context.Y({retry:!1,reason:"Event ".concat(ev," disabled for integration ").concat(this.name," in tracking plan"),type:"Dropped by plan"})),[2,ctx];if(ctx.updateEvent("integrations",(0,tslib_es6.pi)((0,tslib_es6.pi)({},ctx.event.integrations),null==planEvent?void 0:planEvent.integrations)),(null==planEvent?void 0:planEvent.enabled)&&!1===(null==planEvent?void 0:planEvent.integrations[this.name]))return ctx.cancel(new esm_context.Y({retry:!1,reason:"Event ".concat(ev," disabled for integration ").concat(this.name," in tracking plan"),type:"Dropped by plan"})),[2,ctx]}return[4,(0,middleware.applyDestinationMiddleware)(this.name,ctx.event,this.middleware)];case 1:if(null===(afterMiddleware=_c.sent()))return[2,ctx];event=new clz(afterMiddleware,{traverse:!this.disableAutoISOConversion}),ctx.stats.increment("analytics_js.integration.invoke",1,["method:".concat(eventType),"integration_name:".concat(this.name)]),_c.label=2;case 2:return _c.trys.push([2,5,,6]),this.integration?[4,this.integration.invoke.call(this.integration,eventType,event)]:[3,4];case 3:_c.sent(),_c.label=4;case 4:return[3,6];case 5:throw err_1=_c.sent(),ctx.stats.increment("analytics_js.integration.invoke.error",1,["method:".concat(eventType),"integration_name:".concat(this.name)]),err_1;case 6:return[2,ctx]}}))}))},LegacyDestination.prototype.track=function(ctx){return(0,tslib_es6.mG)(this,void 0,void 0,(function(){return(0,tslib_es6.Jh)(this,(function(_a){return[2,this.send(ctx,dist.Track,"track")]}))}))},LegacyDestination.prototype.page=function(ctx){var _a;return(0,tslib_es6.mG)(this,void 0,void 0,(function(){var _this=this;return(0,tslib_es6.Jh)(this,(function(_b){return(null===(_a=this.integration)||void 0===_a?void 0:_a._assumesPageview)&&!this._initialized&&this.integration.initialize(),[2,this.onInitialize.then((function(){return _this.send(ctx,dist.Page,"page")}))]}))}))},LegacyDestination.prototype.identify=function(ctx){return(0,tslib_es6.mG)(this,void 0,void 0,(function(){return(0,tslib_es6.Jh)(this,(function(_a){return[2,this.send(ctx,dist.Identify,"identify")]}))}))},LegacyDestination.prototype.alias=function(ctx){return(0,tslib_es6.mG)(this,void 0,void 0,(function(){return(0,tslib_es6.Jh)(this,(function(_a){return[2,this.send(ctx,dist.Alias,"alias")]}))}))},LegacyDestination.prototype.group=function(ctx){return(0,tslib_es6.mG)(this,void 0,void 0,(function(){return(0,tslib_es6.Jh)(this,(function(_a){return[2,this.send(ctx,dist.Group,"group")]}))}))},LegacyDestination.prototype.scheduleFlush=function(){var _this=this;this.flushing||setTimeout((function(){return(0,tslib_es6.mG)(_this,void 0,void 0,(function(){var _a;return(0,tslib_es6.Jh)(this,(function(_b){switch(_b.label){case 0:return this.flushing=!0,_a=this,[4,flushQueue(this,this.buffer)];case 1:return _a.buffer=_b.sent(),this.flushing=!1,this.buffer.todo>0&&this.scheduleFlush(),[2]}}))}))}),5e3*Math.random())},LegacyDestination}();function ajsDestinations(writeKey,settings,globalIntegrations,options,routingMiddleware,legacyIntegrationSources){var _a,_b;if(void 0===globalIntegrations&&(globalIntegrations={}),void 0===options&&(options={}),(0,environment.s)())return[];settings.plan&&((options=null!=options?options:{}).plan=settings.plan);var routingRules=null!==(_b=null===(_a=settings.middlewareSettings)||void 0===_a?void 0:_a.routingRules)&&void 0!==_b?_b:[],remoteIntegrationsConfig=settings.integrations,localIntegrationsConfig=options.integrations,integrationOptions=(0,merged_options.o)(settings,null!=options?options:{}),adhocIntegrationSources=null==legacyIntegrationSources?void 0:legacyIntegrationSources.reduce((function(acc,integrationSource){var _a;return(0,tslib_es6.pi)((0,tslib_es6.pi)({},acc),((_a={})[function(integrationSource){return("Integration"in integrationSource?integrationSource.Integration:integrationSource).prototype.name}(integrationSource)]=integrationSource,_a))}),{}),installableIntegrations=new Set((0,tslib_es6.ev)((0,tslib_es6.ev)([],Object.keys(remoteIntegrationsConfig).filter((function(name){return function(name,integrationSettings){var _a,type=integrationSettings.type,bundlingStatus=integrationSettings.bundlingStatus,versionSettings=integrationSettings.versionSettings,deviceMode="unbundled"!==bundlingStatus&&("browser"===type||(null===(_a=null==versionSettings?void 0:versionSettings.componentTypes)||void 0===_a?void 0:_a.includes("browser")));return!name.startsWith("Segment")&&"Iterable"!==name&&deviceMode}(name,remoteIntegrationsConfig[name])})),!0),Object.keys(adhocIntegrationSources||{}).filter((function(name){return(0,helpers.PO)(remoteIntegrationsConfig[name])||(0,helpers.PO)(null==localIntegrationsConfig?void 0:localIntegrationsConfig[name])})),!0));return Array.from(installableIntegrations).filter((function(name){return!function(integrationName,globalIntegrations){var allDisableAndNotDefined=!1===globalIntegrations.All&&void 0===globalIntegrations[integrationName];return!1===globalIntegrations[integrationName]||allDisableAndNotDefined}(name,globalIntegrations)})).map((function(name){var version=function(settings){var _a,_b,_c,_d;return null!==(_d=null!==(_b=null===(_a=null==settings?void 0:settings.versionSettings)||void 0===_a?void 0:_a.override)&&void 0!==_b?_b:null===(_c=null==settings?void 0:settings.versionSettings)||void 0===_c?void 0:_c.version)&&void 0!==_d?_d:"latest"}(remoteIntegrationsConfig[name]),destination=new LegacyDestination(name,version,writeKey,integrationOptions[name],options,null==adhocIntegrationSources?void 0:adhocIntegrationSources[name]);return routingRules.filter((function(rule){return rule.destinationName===name})).length>0&&routingMiddleware&&destination.addMiddleware(routingMiddleware),destination}))}}}]);